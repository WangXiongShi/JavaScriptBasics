<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style type="text/css">
        *{
            margin: 0px;
            padding: 0px;
        }
        ul{
            list-style:none;
        }
        p{
            text-align: center;
        }
        li{
            width: 300px;
            background-color: #e8e8e8;
            float: left;
            width: 20%;
        }
        img{
            width: 180px;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <ul id="uls"></ul>
    <a href="list.html">去结算页面</a>

    <script type="text/javascript">
        var dataArr = [
            {imgSrc:'https://i1.mifile.cn/a4/xmad_14966625823457_RclIL.png',title:'红米4X',content:'4100mAh超长续航，8 核处理器',price:'699元起',id:1000,num:1},
            {imgSrc:'https://i1.mifile.cn/a4/xmad_14894013451119_CiBVP.png',title:'红米Note 4X',content:'4100mAh超长续航，多彩金属',price:'999元起',id:1001,num:1},
            {imgSrc:'https://i1.mifile.cn/a4/xmad_15030636163238_WTzlt.png',title:'小米Note 2',content:'最高减600元',price:'2499元起',id:1002,num:1},
            {imgSrc:'https://i1.mifile.cn/a4/xmad_14938805670516_eryYQ.png',title:'小米电视4A 43英寸',content:'全高清HDR，智能语音',price:'1999元',id:1003,num:1},
            {imgSrc:'https://i1.mifile.cn/a4/073b5ddc-9117-4668-adbe-878c928a79da',title:'小米笔记本',content:'更轻更薄，像杂志一样随身携带',price:'3599元起',id:1004,num:1},
        ];

        var uls = document.querySelector("#uls");
        var listArr = localStorage.lists ? JSON.parse(localStorage.lists) : [];
        for(var i = 0; i < dataArr.length; i++){
            var li = document.createElement('li');

            li.innerHTML = '<div><img src="'+dataArr[i].imgSrc+'"></div><p>'+dataArr[i].title+'</p><p>'+dataArr[i].content+'</p><p>'+dataArr[i].price+'</p>';
            li.index = i;
            li.onclick = function(){
                // 判断该数据有没有在localStroage里面
                for(var j = 0; j < listArr.length; j++){
                    if(listArr[j].id == dataArr[this.index].id){
                        alert('重复添加');
                        listArr[j].num = listArr[j].num+1;
                        localStorage.lists = JSON.stringify(listArr);
                        return;
                    }
                }
                alert('已经添加到购物车');
                listArr.push(dataArr[this.index]);
                var str = JSON.stringify(listArr);
                localStorage.lists = str;
            }
            uls.appendChild(li);
        }
    </script>
</body>
</html>