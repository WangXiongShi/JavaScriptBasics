<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style type="text/css">
        *{margin: 0px;padding: 0px;}
        #wrap{width: 300px;height: 400px;border: 1px solid #ccc;position: relative;overflow: hidden;left: 100px;top: 200px;}
        #middle{width: 280px;background: red;position: absolute;top: 0px;left: 0px;}
        #sliderWrap{width: 20px;background: #ccc;height: 400px;position: absolute;right: 0px;top: 0px;}
        #slider{width: 20px;height: 40px;background: yellow;border-radius: 20px;position: absolute;top: 0px;}
    </style>
</head>
<body>
    <div id="wrap">
        <div id="middle">啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的啊实打实大师的</div>
        <div id="sliderWrap">
            <div id="slider"></div>
        </div>
    </div>
    <script type="text/javascript" src='wheel.js'></script>
    <script type="text/javascript">
        var wrap = document.querySelector("#wrap");
        var middle = document.querySelector("#middle");
        var sliderWrap = document.querySelector("#sliderWrap");
        var slider = document.querySelector("#slider");

        // 求比例(计算slider的高度)
        var scale = middle.offsetHeight / wrap.offsetHeight;
        // console.log(scale);
        var sliderH = sliderWrap.offsetHeight / scale;
        if(sliderH <= 40){
            sliderH = 40;
        }else if(sliderH >= sliderWrap.offsetHeight){
            sliderWrap.style.display = 'none';
        }
        slider.style.height = sliderH + 'px';

        // 用来记录slider的top值
        var sliderTop = 0;
        // 键盘事件
        document.onkeydown = function(e){
            var ev = window.event || e;
            switch(ev.keyCode) {
                case 40:
                    console.log('下键盘');
                    sliderTop += 10;
                    moveFn();
                    break;
                case 38:
                    console.log('上键盘');
                    sliderTop -= 10;
                    moveFn();
                    break;
            }
        }

        // 给wrap添加滚轮事件
        addWheelEvent(wrap, function(bol){
            if(bol){
                sliderTop -= 10;
                moveFn();
            }else{
                sliderTop += 10;
                moveFn();
            }
        });

        // 点击sliderWrap
        sliderWrap.onmousedown = function(e){
            var ev = window.event || e;
            console.log(ev.clientY);
            sliderTop = ev.clientY - sliderH / 2 - wrap.offsetTop;
            moveFn();
        }

        // 拖拽slider
        slider.onmousedown = function(){
            document.onmousemove = function(e){
                var ev = window.event || e;
                console.log(ev.clientY);
                sliderTop = ev.clientY - wrap.offsetTop - sliderH / 2;
                moveFn();
            }
        }
        document.onmouseup = function(){
            document.onmousemove = null;
        }
        // 取消默认事件
        document.onmousedown = function(e){
            var ev = window.event || e;
            ev.preventDefault();
        }

        function moveFn(){
            if(sliderTop <= 0){
                sliderTop = 0;
            }else if(sliderTop >= sliderWrap.offsetHeight - sliderH){
                sliderTop = sliderWrap.offsetHeight - sliderH;
            }
            var sliderScale = sliderTop / (sliderWrap.offsetHeight - sliderH);
            middle.style.top = -sliderScale * (middle.offsetHeight - wrap.offsetHeight) + 'px';

            slider.style.top = sliderTop + 'px';
        }








    </script>
</body>
</html>